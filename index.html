<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=0.6">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="assets/styles.css">

<div align="center" style="height: 800px; margin: auto;">

    <a href="https://github.com/ErezHorev/GameOfLifeJS">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67"
            alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png">
    </a>

    <head>
        <h1 class=title>Conway's Game Of Life</h1>
        <title>Conway's Game Of Life</title>
    </head>

    <body>
        <div>
            <div>
                <button type="button" id="startBtn" class="startBtn w3-xlarge">Start</button>
                <select id="patternSelector">
                    <!-- All options are auto generated by the JS code below -->
                </select>
            </div>
            <div>
                <canvas id="gameCanvas" class="gameCanvas"></canvas>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script type="text/javascript" src="assets/app.js"></script>
        <script type="text/javascript">
            // populate patternSelector from supported patterns
            for (var key in allPatterns()) {
                $('#patternSelector').append($('<option>', {
                    value: key,
                    text: allPatterns()[key].name
                }));
            }

            var game = new GameOfLife(
                setupCanvas(defaults.rows, defaults.lines),
                defaults.rows, defaults.lines);

            // event handlers
            $("#patternSelector").change(function () {
                console.log("Changing pattern");
                var selected = $("#patternSelector").find(":selected");
                pattern = allPatterns()[selected.val()];
                game.setPattern(pattern.get());
                stop(game);
            });
            $('#startBtn').click(function () {
                if ($('#startBtn').text() == "Start") {
                    start(game);
                    return
                }
                stop(game);
            });

            var stop = function (game) {
                if (game.isRunning) { setButton("Start"); };
                game.stop();
            };
            var start = function (game) {
                if (game.isRunning) { game.stop(); };
                game.start(); setButton("Stop");
            };
            var setButton = function (text) {
                // changes button's text //TODO: feels hacky, we need to make it more elegant
                $('#startBtn').toggleClass('highlight');
                $('#startBtn').text(text);
            };

            $("#gameCanvas").click(function (e) {
                canvasClick(e);
            });

            $("#gameCanvas").mouseup(function (e) {
                $(this).unbind("mousemove", canvasClick);
            })
            $("#gameCanvas").mousedown(function (e) {
                $(this).bind("mousemove", canvasClick);
            });

            var allPoints = [];
            var trackPoints = function (e) {
                var x = Math.floor(e.offsetX / cellSize)
                var y = Math.floor(e.offsetY / cellSize)
                allPoints.push([x, y]);
                console.log(allPoints);
            };
            var canvasClick = function (e) {
                trackPoints(e)
                if (!game.isRunning) { // don't draw during a running game
                    game.drawCell(e.offsetX, e.offsetY)
                };
            };
        </script>
    </body>

</html>